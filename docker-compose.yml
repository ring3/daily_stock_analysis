# ===================================
# A股自选股智能分析系统 - Docker Compose
# ===================================
# 一键启动，自动管理容器生命周期

version: '3.8'

services:
  stock-analyzer:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: stock-analyzer
    restart: unless-stopped
    
    # 环境变量（从 .env 文件加载）
    env_file:
      - .env
    
    # 挂载卷（持久化数据）
    volumes:
      - ./data:/app/data          # 数据库
      - ./logs:/app/logs          # 日志文件
      - ./reports:/app/reports    # 分析报告
    
    # 网络设置（如果需要代理，取消注释下面的配置）
    # network_mode: "host"
    # 或使用环境变量设置代理
    environment:
      - TZ=Asia/Shanghai
      # 代理设置（如果需要）
      # - http_proxy=http://host.docker.internal:10809
      # - https_proxy=http://host.docker.internal:10809
    
    # 日志配置
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    
    # 资源限制
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M

# 如果需要网络隔离，可以定义网络
# networks:
#   stock-net:
#     driver: bridge
